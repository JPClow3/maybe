{% extends 'base.html' %}

{% block title %}{% if budget %}Editar{% else %}Novo{% endif %} Orçamento - Maybe Finance{% endblock %}

{% block content %}
<div class="px-4 py-6 sm:px-0">
    <div class="max-w-2xl mx-auto">
        <a href="{% if budget %}{% url 'budget_detail' budget.pk %}{% else %}{% url 'budget_list' %}{% endif %}" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 mb-4 inline-block">← Voltar</a>
        <div class="mb-6">
            <h1 class="text-3xl font-bold bg-gradient-to-r from-primary-600 via-primary-500 to-primary-400 dark:from-primary-400 dark:via-primary-300 dark:to-primary-200 bg-clip-text text-transparent">
                {% if budget %}Editar{% else %}Novo{% endif %} Orçamento
            </h1>
        </div>
        
        <div class="card">
            <form method="post" class="space-y-6">
                {% csrf_token %}
                
                {% if not budget %}
                <div>
                    <label for="month" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        Mês <span class="text-danger-600 dark:text-danger-400" aria-label="required">*</span>
                    </label>
                    <input 
                        type="month" 
                        name="month" 
                        id="month"
                        class="form-input"
                        value="{{ current_month }}"
                        required
                    />
                </div>
                {% endif %}
                
                <div>
                    <label for="budgeted_spending" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        Orçamento Total (R$)
                    </label>
                    <input 
                        type="text" 
                        name="budgeted_spending" 
                        id="budgeted_spending"
                        class="form-input"
                        placeholder="0,00"
                        value="{% if budget %}{{ budget.budgeted_spending|floatformat:2|default:'' }}{% endif %}"
                    />
                </div>
                
                {% if budget %}
                <div>
                    <label for="expected_income" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        Receita Esperada (R$)
                    </label>
                    <input 
                        type="text" 
                        name="expected_income" 
                        id="expected_income"
                        class="form-input"
                        placeholder="0,00"
                        value="{% if budget.expected_income %}{{ budget.expected_income|floatformat:2 }}{% endif %}"
                    />
                </div>
                {% endif %}
                
                <div class="flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700">
                    <a href="{% if budget %}{% url 'budget_detail' budget.pk %}{% else %}{% url 'budget_list' %}{% endif %}" class="btn-secondary" hx-boost="false">
                        Cancelar
                    </a>
                    <button type="submit" class="btn-primary relative">
                        <span class="htmx-indicator-button">Salvar</span>
                        <span class="htmx-indicator absolute right-2 top-1/2 -translate-y-1/2">
                            {% include 'partials/spinner.html' with size='h-5 w-5' color='text-white' %}
                        </span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

